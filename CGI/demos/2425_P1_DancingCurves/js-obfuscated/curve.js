const a1_0x28bb7a=a1_0x1ee6;(function(_0x3eddb5,_0x240582){const _0x178612=a1_0x1ee6,_0x479eb9=_0x3eddb5();while(!![]){try{const _0x444cf7=parseInt(_0x178612(0x101))/0x1*(-parseInt(_0x178612(0xed))/0x2)+parseInt(_0x178612(0x112))/0x3*(parseInt(_0x178612(0xf6))/0x4)+parseInt(_0x178612(0xfb))/0x5+parseInt(_0x178612(0x10f))/0x6+parseInt(_0x178612(0x117))/0x7*(-parseInt(_0x178612(0xff))/0x8)+parseInt(_0x178612(0x111))/0x9+-parseInt(_0x178612(0x102))/0xa;if(_0x444cf7===_0x240582)break;else _0x479eb9['push'](_0x479eb9['shift']());}catch(_0x1a0d73){_0x479eb9['push'](_0x479eb9['shift']());}}}(a1_0x1038,0xaf653));function a1_0x1038(){const _0x3e0959=['uniform1ui','point\x20at\x20','uniform4fv','\x20has\x20','Curve\x20','5985912VYyEkL','UNSIGNED_INT','7662645BzJWCG','421536yYULKM','length','getUniformLocation','n_points','vertexAttribIPointer','7tKwFjY','enableVertexAttribArray','18060hvHkEQ','a_idx','random','random_color','add_point','u_pt_size','createVertexArray','bufferData','POINTS','4gXYIpy','u_color','update_point','push','random_velocity','5442980eRnkLA','finish','log','uniform2f','9112488hEGFGg','ARRAY_BUFFER','53pgmoRG','7420950ZiYMUZ','createBuffer','init','draw','bindBuffer','u_P[','bindVertexArray','u_point'];a1_0x1038=function(){return _0x3e0959;};return a1_0x1038();}import{vec2,vec4,add,scale}from'../../../libs/MV.js';function a1_0x1ee6(_0x2a29a1,_0x315ec3){const _0x103841=a1_0x1038();return a1_0x1ee6=function(_0x1ee654,_0x535a75){_0x1ee654=_0x1ee654-0xec;let _0x30d823=_0x103841[_0x1ee654];return _0x30d823;},a1_0x1ee6(_0x2a29a1,_0x315ec3);}const max_sample_points=0xea60;export const B_SPLINE=0x1;export const CATMULL_ROM=0x2;export const BEZIER=0x3;export class Curve{static #vao=null;#points;#velocities;#type;#color;#base_vel;#pt_size;static[a1_0x28bb7a(0x104)](_0x440b9d,_0x21440a){const _0x4abbc0=a1_0x28bb7a;let _0x4cd30c=[];const _0x493de8=_0x440b9d[_0x4abbc0(0x103)]();_0x440b9d[_0x4abbc0(0x106)](_0x440b9d['ARRAY_BUFFER'],_0x493de8);for(let _0x3802e8=0x0;_0x3802e8<=max_sample_points;_0x3802e8++)_0x4cd30c[_0x4abbc0(0xf9)](_0x3802e8);_0x440b9d[_0x4abbc0(0xf4)](_0x440b9d[_0x4abbc0(0x100)],new Uint32Array(_0x4cd30c),_0x440b9d['STATIC_DRAW']),Curve.#vao=_0x440b9d[_0x4abbc0(0xf3)](),_0x440b9d[_0x4abbc0(0x108)](Curve.#vao);const _0x4ea923=_0x440b9d['getAttribLocation'](_0x21440a,_0x4abbc0(0xee));_0x440b9d[_0x4abbc0(0x116)](_0x4ea923,0x1,_0x440b9d[_0x4abbc0(0x110)],![],0x0,0x0),_0x440b9d[_0x4abbc0(0xec)](_0x4ea923),_0x440b9d['bindVertexArray'](null);}constructor(_0x1df69f){const _0x24156e=a1_0x28bb7a;this.#points=[],this.#velocities=[],this.#color=this[_0x24156e(0xf0)](),this.#type=B_SPLINE,this.#base_vel=this['random_velocity'](0.5),this.#pt_size=Math[_0x24156e(0xef)]()*0x19+0x19;}get[a1_0x28bb7a(0x115)](){const _0x40e93b=a1_0x28bb7a;return this.#points[_0x40e93b(0x113)];}set['type'](_0x8c8b35){this.#type=_0x8c8b35;}['at'](_0x2e7271){return this.#points[_0x2e7271];}[a1_0x28bb7a(0xf0)](){const _0x5c30c6=a1_0x28bb7a;return vec4(Math[_0x5c30c6(0xef)]()*0.9+0.1,Math[_0x5c30c6(0xef)]()*0.9+0.1,Math[_0x5c30c6(0xef)]()*0.9+0.1,Math[_0x5c30c6(0xef)]()*0.1+0.1);}['random_velocity'](_0x7d5303){function _0x3b5aaf(){const _0x26d81a=a1_0x1ee6,_0x53c870=0.5;return Math[_0x26d81a(0xef)]()*_0x53c870-_0x53c870/0x2;}return vec2(_0x7d5303*_0x3b5aaf(),_0x7d5303*_0x3b5aaf());}[a1_0x28bb7a(0xf1)](_0x37e706){const _0x30617b=a1_0x28bb7a;this.#points[_0x30617b(0xf9)](_0x37e706);const _0x127942=this[_0x30617b(0xfa)](0.1);this.#velocities['push'](add(_0x127942,this.#base_vel));}[a1_0x28bb7a(0xf8)](_0x29c2c0,_0xbc3fec){const _0x43dada=this['at'](_0x29c2c0);}[a1_0x28bb7a(0xfc)](){const _0x2f45d0=a1_0x28bb7a,_0x5f23a3=this.#points[this[_0x2f45d0(0x115)]-0x1][0x0]-this.#points[0x0][0x0],_0x18092f=this.#points[this[_0x2f45d0(0x115)]-0x1][0x1]-this.#points[0x0][0x1];}[a1_0x28bb7a(0x105)](_0x5088b1,_0x37463b,_0x8e4b03,_0x21dc9f){const _0x26b867=a1_0x28bb7a;if(this['n_points']<0x4)return;const _0x3d5d49=_0x5088b1[_0x26b867(0x114)](_0x37463b,'u_type');_0x5088b1[_0x26b867(0x10a)](_0x3d5d49,this.#type);const _0x12725e=_0x5088b1[_0x26b867(0x114)](_0x37463b,_0x26b867(0xf7));_0x5088b1[_0x26b867(0x10c)](_0x12725e,this.#color);const _0x316a02=_0x5088b1[_0x26b867(0x114)](_0x37463b,_0x26b867(0xf2));_0x5088b1['uniform1f'](_0x316a02,this.#pt_size);const _0x349083=_0x5088b1['getUniformLocation'](_0x37463b,'u_n_steps');_0x5088b1[_0x26b867(0x10a)](_0x349083,_0x8e4b03);const _0x35fca9=_0x5088b1['getUniformLocation'](_0x37463b,'u_n_points');_0x5088b1['uniform1ui'](_0x35fca9,this[_0x26b867(0x115)]);for(let _0x2f3d4e=0x0;_0x2f3d4e<this['n_points'];_0x2f3d4e++){const _0x58234e=_0x5088b1[_0x26b867(0x114)](_0x37463b,_0x26b867(0x107)+_0x2f3d4e+']');let _0x1af83a=this['at'](_0x2f3d4e);_0x5088b1[_0x26b867(0xfe)](_0x58234e,_0x1af83a[0x0],_0x1af83a[0x1]);}const _0x199c85=_0x5088b1[_0x26b867(0x114)](_0x37463b,_0x26b867(0x109));_0x5088b1[_0x26b867(0x108)](Curve.#vao);let _0x106b09;if(this.#type==B_SPLINE||this.#type==CATMULL_ROM)_0x106b09=_0x8e4b03*(this[_0x26b867(0x115)]-0x3)+0x1;else _0x106b09=_0x8e4b03*Math['floor']((this[_0x26b867(0x115)]-0x1)/0x3)+0x1;_0x21dc9f&0x1&&(_0x5088b1[_0x26b867(0x10a)](_0x199c85,0x1),_0x5088b1['drawArrays'](_0x5088b1[_0x26b867(0xf5)],0x0,_0x106b09)),_0x21dc9f&0x2&&(_0x5088b1[_0x26b867(0x10a)](_0x199c85,0x0),_0x5088b1['drawArrays'](_0x5088b1['LINE_STRIP'],0x0,_0x106b09)),_0x5088b1[_0x26b867(0x108)](null);}['update'](_0x235e05){const _0x15a1a6=a1_0x28bb7a;if(this[_0x15a1a6(0x115)]<0x4)return;for(let _0x48103a=0x0;_0x48103a<this[_0x15a1a6(0x115)];_0x48103a++){this.#points[_0x48103a]=add(this.#points[_0x48103a],scale(_0x235e05,this.#velocities[_0x48103a]));if(this.#points[_0x48103a][0x0]>0x1||this.#points[_0x48103a][0x0]<-0x1)this.#velocities[_0x48103a][0x0]=-this.#velocities[_0x48103a][0x0];if(this.#points[_0x48103a][0x1]>0x1||this.#points[_0x48103a][0x1]<-0x1)this.#velocities[_0x48103a][0x1]=-this.#velocities[_0x48103a][0x1];}}['debug'](){const _0x13a579=a1_0x28bb7a;console[_0x13a579(0xfd)](_0x13a579(0x10e)+this+_0x13a579(0x10d)+this[_0x13a579(0x115)]);for(const _0xbbb9fa of this.#points){console[_0x13a579(0xfd)](_0x13a579(0x10b)+_0xbbb9fa[0x0]+',\x20'+_0xbbb9fa[0x1]);}}};